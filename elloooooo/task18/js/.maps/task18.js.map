{"version":3,"sources":["task18.coffee"],"names":[],"mappings":"AAYA,IAAA;;AAAA,KAAA,GAEE;EAAA,SAAA,EAAW,EAAX;EACA,IAAA,EAAM,IADN;EAEA,IAAA,EAAM,IAFN;EAGA,IAAA,EAAM,SAAA;AACJ,QAAA;IAAA,OAAO,CAAC,GAAR,CAAY,eAAZ;IACA,IAAG,IAAC,CAAA,IAAD,KAAS,IAAZ;MACE,OAAO,CAAC,GAAR,CAAY,4BAAZ;AACA,aAFF;KAAA,MAAA;MAIE,GAAA,GAAM,IAAC,CAAA;MAEP,WAAA,GAAc,IAAC,CAAA,IAAI,CAAC;MACpB,IAAG,sBAAH;QACE,IAAC,CAAA,IAAI,CAAC,IAAI,CAAC,IAAX,GAAkB;QAClB,IAAC,CAAA,IAAD,GAAQ,IAAC,CAAA,IAAI,CAAC,KAFhB;OAAA,MAAA;QAIE,IAAC,CAAA,IAAD,GAAQ;QACR,IAAC,CAAA,IAAD,GAAQ,KALV;;MAMA,OAAO,IAAC,CAAA,SAAU,CAAA,WAAA,EAbpB;;WAcA;EAhBI,CAHN;EAqBA,IAAA,EAAM,SAAA;AACJ,QAAA;IAAA,OAAO,CAAC,GAAR,CAAY,eAAZ;IACA,IAAG,IAAC,CAAA,IAAD,KAAS,IAAZ;MACE,OAAO,CAAC,GAAR,CAAY,2BAAZ;AACA,aAFF;KAAA,MAAA;MAIE,GAAA,GAAM,IAAC,CAAA;MACP,WAAA,GAAc,IAAC,CAAA,IAAI,CAAC;MACpB,IAAG,sBAAH;QACE,IAAC,CAAA,IAAI,CAAC,IAAI,CAAC,IAAX,GAAkB;QAClB,IAAC,CAAA,IAAD,GAAQ,IAAC,CAAA,IAAI,CAAC,KAFhB;OAAA,MAAA;QAIE,IAAC,CAAA,IAAD,GAAQ;QACR,IAAC,CAAA,IAAD,GAAQ,KALV;;MAMA,OAAO,IAAC,CAAA,SAAU,CAAA,WAAA,EAZpB;;WAaA;EAfI,CArBN;EAsCA,KAAA,EAAO,SAAC,IAAD;IACL,OAAO,CAAC,GAAR,CAAY,cAAZ;IACA,IAAG,IAAC,CAAA,IAAD,KAAS,IAAZ;MACE,IAAC,CAAA,IAAD,GAAQ;MACR,IAAC,CAAA,IAAD,GAAQ,KAFV;KAAA,MAAA;MAIE,IAAI,CAAC,IAAL,GAAY,IAAC,CAAA;MACb,IAAC,CAAA,IAAI,CAAC,IAAN,GAAa;MACb,IAAC,CAAA,IAAD,GAAQ,KANV;;WAOA,IAAC,CAAA,SAAU,CAAA,IAAI,CAAC,EAAL,CAAX,GAAsB;EATjB,CAtCP;EAiDA,KAAA,EAAO,SAAC,IAAD;IACL,OAAO,CAAC,GAAR,CAAY,cAAZ;IACA,IAAG,IAAC,CAAA,IAAD,KAAS,IAAZ;MACE,IAAC,CAAA,IAAD,GAAQ;MACR,IAAC,CAAA,IAAD,GAAQ,KAFV;KAAA,MAAA;MAIE,IAAI,CAAC,IAAL,GAAY,IAAC,CAAA;MACb,IAAC,CAAA,IAAI,CAAC,IAAN,GAAa;MACb,IAAC,CAAA,IAAD,GAAQ,KANV;;WAOA,IAAC,CAAA,SAAU,CAAA,IAAI,CAAC,EAAL,CAAX,GAAsB;EATjB,CAjDP;EA4DA,UAAA,EAAY,SAAC,EAAD;AACV,QAAA;IAAA,OAAO,CAAC,GAAR,CAAY,qBAAA,GAAsB,EAAlC;IACA,OAAA,GAAU,IAAC,CAAA,SAAU,CAAA,EAAA;IACrB,IAAO,oBAAP;MACE,IAAC,CAAA,IAAD,CAAM,OAAN,EADF;KAAA,MAEK,IAAO,oBAAP;MACH,IAAC,CAAA,IAAD,CAAM,OAAN,EADG;KAAA,MAAA;MAGH,OAAO,CAAC,IAAI,CAAC,IAAb,GAAoB,OAAO,CAAC;MAC5B,OAAO,CAAC,IAAI,CAAC,IAAb,GAAoB,OAAO,CAAC,KAJzB;;WAKL,OAAO,IAAC,CAAA,SAAU,CAAA,OAAO,CAAC,EAAR;EAVR,CA5DZ;;;AA0EF,IAAA,GAAO,SAAC,EAAD,EAAK,GAAL,EAAU,IAAV,EAAgB,IAAhB;EACL,IAAC,CAAA,EAAD,GAAM;EACN,IAAC,CAAA,GAAD,GAAO;EACP,IAAC,CAAA,IAAD,GAAQ;SACR,IAAC,CAAA,IAAD,GAAQ;AAJH;;AAOP,WAAA,GAAc,SAAA;SAAK,CAAK,IAAA,IAAA,CAAA,CAAL,CAAY,CAAC,OAAb,CAAA;AAAL;;AAUd,KAAA,GAAQ,SAAA;EACN,IAAA,GACE;IAAA,GAAA,EAAK,QAAQ,CAAC,cAAT,CAAwB,UAAxB,CAAmC,CAAC,KAAzC;IACA,EAAA,EAAI,WAAA,CAAA,CADJ;;EAEF,KAAK,CAAC,KAAN,CAAY,IAAZ;SACA,MAAA,CAAA;AALM;;AAOR,KAAA,GAAQ,SAAA;EACN,IAAA,GACE;IAAA,GAAA,EAAK,QAAQ,CAAC,cAAT,CAAwB,UAAxB,CAAmC,CAAC,KAAzC;IACA,EAAA,EAAI,WAAA,CAAA,CADJ;;EAEF,KAAK,CAAC,KAAN,CAAY,IAAZ;SACA,MAAA,CAAA;AALM;;AAOR,IAAA,GAAO,SAAA;EACL,IAAA,GACE;IAAA,GAAA,EAAK,QAAQ,CAAC,cAAT,CAAwB,UAAxB,CAAmC,CAAC,KAAzC;IACA,EAAA,EAAI,WAAA,CAAA,CADJ;;EAEF,KAAK,CAAC,IAAN,CAAA;SACA,MAAA,CAAA;AALK;;AAOP,IAAA,GAAO,SAAA;EACL,IAAA,GACE;IAAA,GAAA,EAAK,QAAQ,CAAC,cAAT,CAAwB,UAAxB,CAAmC,CAAC,KAAzC;IACA,EAAA,EAAI,WAAA,CAAA,CADJ;;EAEF,KAAK,CAAC,IAAN,CAAA;SACA,MAAA,CAAA;AALK;;AAOP,UAAA,GAAW,SAAC,OAAD;EACT,KAAK,CAAC,UAAN,CAAiB,OAAjB;SACA,MAAA,CAAA;AAFS;;AAIX,MAAA,GAAS,SAAA;AACP,MAAA;EAAA,IAAA,GAAO,QAAQ,CAAC,cAAT,CAAwB,SAAxB;EACP,OAAA,GAAU;EACV,OAAO,CAAC,IAAR,CAAa,MAAb;EACA,OAAA,GAAU,KAAK,CAAC;AAChB,SAAM,eAAN;IACE,OAAO,CAAC,IAAR,CAAa,4BAAA,GAA6B,OAAO,CAAC,EAArC,GAAwC,IAAxC,GAA4C,OAAO,CAAC,GAApD,GAAwD,OAArE;IACA,OAAA,GAAU,OAAO,CAAC;EAFpB;EAGA,OAAO,CAAC,IAAR,CAAa,OAAb;SACA,IAAI,CAAC,SAAL,GAAiB,OAAO,CAAC,IAAR,CAAa,EAAb;AATV;;AAWT,IAAA,GAAO,SAAA;EACL,QAAQ,CAAC,cAAT,CAAwB,QAAxB,CAAiC,CAAC,gBAAlC,CAAmD,OAAnD,EAA4D,KAA5D;EACA,QAAQ,CAAC,cAAT,CAAwB,QAAxB,CAAiC,CAAC,gBAAlC,CAAmD,OAAnD,EAA4D,KAA5D;EACA,QAAQ,CAAC,cAAT,CAAwB,OAAxB,CAAgC,CAAC,gBAAjC,CAAkD,OAAlD,EAA2D,IAA3D;EACA,QAAQ,CAAC,cAAT,CAAwB,OAAxB,CAAgC,CAAC,gBAAjC,CAAkD,OAAlD,EAA2D,IAA3D;SAEA,QAAQ,CAAC,cAAT,CAAwB,SAAxB,CAAkC,CAAC,gBAAnC,CAAoD,OAApD,EAA6D,SAAC,KAAD;IAC3D,IAAG,KAAK,CAAC,MAAM,CAAC,QAAQ,CAAC,WAAtB,CAAA,CAAA,KAAuC,IAA1C;aACE,UAAA,CAAW,KAAK,CAAC,MAAM,CAAC,OAAO,CAAC,EAAhC,EADF;;EAD2D,CAA7D,EAGE,KAHF;AANK;;AAWP,IAAA,CAAA","file":"task18.js","sourceRoot":"/source/","sourcesContent":["#hash表存节点\r\n#节点带指针形成双向链表\r\n#维护头指针(节点id)与尾指针(节点id)\r\n#\r\n#node=\r\n#  prev : 0\r\n#  next : 0\r\n#  val : 0\r\n#  id : 0\r\n#\r\n# id生成：时间戳\r\n\r\nqueue =\r\n# 作为hash表\r\n  cachedMap: {}\r\n  head: null\r\n  tail: null\r\n  lpop: ()->\r\n    console.log \"pop from head\"\r\n    if @head == null\r\n      console.log \"pop from head, but no node\"\r\n      return\r\n    else\r\n      res = @head\r\n      # 更改指针指向\r\n      nodeIdToDel = @head.id\r\n      if @head.next?\r\n        @head.next.prev = null\r\n        @head = @head.next\r\n      else#只有一个节点\r\n        @head = null\r\n        @tail = null\r\n      delete @cachedMap[nodeIdToDel]\r\n    res\r\n\r\n  rpop: ()->\r\n    console.log \"pop from tail\"\r\n    if @tail == null\r\n      console.log \"pop from tail,but no node\"\r\n      return\r\n    else\r\n      res = @tail\r\n      nodeIdToDel = @tail.id\r\n      if @tail.prev?\r\n        @tail.prev.next = null\r\n        @tail = @tail.prev\r\n      else#只有一个节点\r\n        @tail = null\r\n        @head = null\r\n      delete @cachedMap[nodeIdToDel]\r\n    res\r\n\r\n  lpush: (node)->\r\n    console.log \"push to head\"\r\n    if @head == null\r\n      @head = node\r\n      @tail = node\r\n    else\r\n      node.next = @head\r\n      @head.prev = node\r\n      @head = node\r\n    @cachedMap[node.id] = node\r\n\r\n  rpush: (node)->\r\n    console.log \"push to tail\"\r\n    if @tail == null\r\n      @tail = node\r\n      @head = node\r\n    else\r\n      node.prev = @tail\r\n      @tail.next = node\r\n      @tail = node\r\n    @cachedMap[node.id] = node\r\n\r\n  deleteNode: (id)->\r\n    console.log \"delete node by Id: #{id}\"\r\n    curNode = @cachedMap[id]\r\n    if not curNode.prev?\r\n      @lpop(curNode)\r\n    else if not curNode.next?\r\n      @rpop(curNode)\r\n    else\r\n      curNode.prev.next = curNode.next\r\n      curNode.next.prev = curNode.prev\r\n    delete @cachedMap[curNode.id]\r\n\r\n\r\n#node 构造函数\r\nnode = (id, val, prev, next)->\r\n  @id = id\r\n  @val = val\r\n  @prev = prev\r\n  @next = next\r\n\r\n\r\nidGenerator = ()-> (new Date()).valueOf();\r\n\r\n##test\r\n#queue.rpush({id: 3, val: 30})\r\n#queue.lpush({id: 1, val: 10})\r\n#queue.lpush({id: 2, val: 20})\r\n#queue.rpush({id: 4, val: 40})\r\n#queue.deleteNode(4)\r\n#console.log(queue.cachedMap)\r\n\r\nlpush = ()->\r\n  node =\r\n    val: document.getElementById('node_val').value\r\n    id: idGenerator()\r\n  queue.lpush(node)\r\n  render()\r\n\r\nrpush = ()->\r\n  node =\r\n    val: document.getElementById('node_val').value\r\n    id: idGenerator()\r\n  queue.rpush(node)\r\n  render()\r\n\r\nlpop = ()->\r\n  node =\r\n    val: document.getElementById('node_val').value\r\n    id: idGenerator()\r\n  queue.lpop()\r\n  render()\r\n\r\nrpop = ()->\r\n  node =\r\n    val: document.getElementById('node_val').value\r\n    id: idGenerator()\r\n  queue.rpop()\r\n  render()\r\n\r\ndeleteNode=(node_id)->\r\n  queue.deleteNode(node_id)\r\n  render()\r\n\r\nrender = ()->\r\n  disp = document.getElementById('display')\r\n  nodeStr = []\r\n  nodeStr.push('<ul>')\r\n  curNode = queue.head\r\n  while curNode?\r\n    nodeStr.push(\"<li class='node' data-id='#{curNode.id}'>#{curNode.val}</li>\")\r\n    curNode = curNode.next\r\n  nodeStr.push('</ul>')\r\n  disp.innerHTML = nodeStr.join(\"\")\r\n\r\ninit = ()->\r\n  document.getElementById('l-push').addEventListener('click', lpush)\r\n  document.getElementById('r-push').addEventListener('click', rpush)\r\n  document.getElementById('l-pop').addEventListener('click', lpop)\r\n  document.getElementById('r-pop').addEventListener('click', rpop)\r\n  # 为每个li节点绑定一个点击删除事件\r\n  document.getElementById('display').addEventListener('click', (event)->\r\n    if(event.target.nodeName.toLowerCase() == 'li')\r\n      deleteNode(event.target.dataset.id)\r\n  , false)\r\n\r\ninit()\r\n\r\n"]}